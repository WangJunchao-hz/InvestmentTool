(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"18ca":function(t,n,e){"use strict";e.r(n);var a=e("a5a4"),i=e.n(a);for(var s in a)"default"!==s&&function(t){e.d(n,t,(function(){return a[t]}))}(s);n["default"]=i.a},2479:function(t,n,e){"use strict";(function(t){e("2c9b");a(e("66fd"));var n=a(e("cc5c"));function a(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])},"9e84":function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return s})),e.d(n,"a",(function(){return a}));var a={uniNoticeBar:function(){return e.e("uni_modules/uni-notice-bar/components/uni-notice-bar/uni-notice-bar").then(e.bind(null,"52fe"))},uniGroup:function(){return e.e("uni_modules/uni-group/components/uni-group/uni-group").then(e.bind(null,"882a"))},uniList:function(){return e.e("uni_modules/uni-list/components/uni-list/uni-list").then(e.bind(null,"7a2d"))},uniListItem:function(){return e.e("uni_modules/uni-list/components/uni-list-item/uni-list-item").then(e.bind(null,"4ea7"))},noData:function(){return e.e("components/no-data/no-data").then(e.bind(null,"d7b2"))},uniFab:function(){return e.e("uni_modules/uni-fab/components/uni-fab/uni-fab").then(e.bind(null,"23fc4"))}},i=function(){var t=this,n=t.$createElement;t._self._c},s=[]},a5a4:function(t,n,e){"use strict";(function(t,e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=t.database(),i=a.command,s="plan",u="account",o={data:function(){return{nodata:!1,indexData:!1,userId:"",total:0,fixedAsset:0,floatAsset:0,liabilities:0,planLists:[],planText:"暂无进行中的计划",pattern:{color:"#303133",buttonColor:"#007aff"},fastNav:[{iconPath:"/static/images/zhushou.png",selectedIconPath:"/static/images/zhushou-active.png",text:"计划",active:!1,path:"/pages/assistant/add"},{iconPath:"/static/images/zichan.png",selectedIconPath:"/static/images/zichan-active.png",text:"资产",active:!1,path:"/pages/assets/add"},{iconPath:"/static/images/gongju.png",selectedIconPath:"/static/images/gongju-active.png",text:"工具",active:!1,path:"/pages/tools/add"}]}},onReady:function(){var t=this,n=setInterval((function(){t.userId=getApp().globalData.userId,t.userId&&(t.initPage(),clearInterval(n))}),8)},onShow:function(){this.userId&&this.initPage()},methods:{initPage:function(){var t=this;e.showLoading({mask:!0}),Promise.all([this.getAccountLists(),this.getPlanLists()]).then((function(n){n[0]&&n[0].length||n[1]&&n[1].length?(t.indexData=!0,t.nodata=!1):(t.nodata=!0,t.indexData=!1)})).catch((function(t){console.error(t),e.showModal({content:"请求失败！",showCancel:!1})})).finally((function(){e.hideLoading()}))},getAccountLists:function(){var t=this;return new Promise((function(n,e){a.collection(u).where({userId:i.eq(t.userId)}).get().then((function(e){n(e.result.data),e.result.data.length&&(t.total=0,t.fixedAsset=0,t.floatAsset=0,t.liabilities=0,e.result.data.forEach((function(n){switch(n.type.relationType){case"fixedAsset":t.fixedAsset=t.$NP.plus(t.fixedAsset,n.amount);break;case"floatAsset":t.floatAsset=t.$NP.plus(t.floatAsset,n.amount);break;case"liabilities":t.liabilities=t.$NP.plus(t.liabilities,n.amount);break}var e=t.$NP.plus(t.fixedAsset,t.floatAsset);t.total=t.$NP.minus(e,t.liabilities)})))})).catch((function(t){e(t)}))}))},getPlanLists:function(){var t=this;return new Promise((function(n,e){a.collection(s).where({userId:i.eq(t.userId),opType:"buy"}).orderBy("updateDate desc").get().then((function(e){if(e.result.data.length){t.planText="".concat(e.result.data.length," 条计划进行中"),t.planLists=[];var a=new Map;e.result.data.forEach((function(t){var n=a.get(t.planType.field);if(n)n.children.push(t);else{var e={id:t.planType._id,name:t.planType.name,field:t.planType.field,children:[t]};a.set(t.planType.field,e)}})),a.forEach((function(n){t.planLists.push(n)})),n(e.result.data)}})).catch((function(t){e(t)}))}))},fabTrigger:function(t){this.fastNav[t.index].active=!this.fastNav[t.index].active,this.fastNav[t.index].active&&this.fastNav[t.index].path&&e.navigateTo({url:this.fastNav[t.index].path})}}};n.default=o}).call(this,e("a9ff")["default"],e("543d")["default"])},cc5c:function(t,n,e){"use strict";e.r(n);var a=e("9e84"),i=e("18ca");for(var s in i)"default"!==s&&function(t){e.d(n,t,(function(){return i[t]}))}(s);var u,o=e("f0c5"),c=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,"b990b27e",null,!1,a["a"],u);n["default"]=c.exports}},[["2479","common/runtime","common/vendor"]]]);